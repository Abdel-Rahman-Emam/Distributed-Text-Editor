{"version":3,"sources":["TextEditor.js","App.js","index.js"],"names":["TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","documentId","useParams","id","useState","socket","setSocket","quill","setQuill","useEffect","s","io","process","PORT","console","log","engine","hostname","disconnect","once","document","setContents","enable","emit","interval","setInterval","getContents","clearInterval","handler","delta","updateContents","on","off","oldDelta","source","wrapperRef","useCallback","wrapper","innerHTML","editor","createElement","append","q","Quill","theme","modules","toolbar","disable","setText","className","ref","App","path","exact","to","uuidV4","ReactDOM","render","StrictMode","getElementById"],"mappings":"yNAOMA,EAAkB,CACtB,CAAC,CAAEC,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,KAC9B,CAAC,CAAEC,KAAM,KACT,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,OAAQ,SAAU,aACnB,CAAC,CAAEC,MAAO,IAAM,CAAEC,WAAY,KAC9B,CAAC,CAAEC,OAAQ,OAAS,CAAEA,OAAQ,UAC9B,CAAC,CAAEC,MAAO,KACV,CAAC,QAAS,aAAc,cACxB,CAAC,UAKY,SAASC,IAAc,IAGxBC,EAAeC,cAAnBC,GAH2B,EAIPC,qBAJO,mBAI5BC,EAJ4B,KAIpBC,EAJoB,OAKTF,qBALS,mBAK5BG,EAL4B,KAKrBC,EALqB,KAOnCC,qBAAU,WAER,IAAIC,EAAIC,YAAGC,4JAAYC,MAAU,+CAIjC,OAHAP,EAAUI,GACVI,QAAQC,IAAIL,EAAEC,GAAGK,OAAOC,UACxBP,EAAIC,YAAG,UAAGD,EAAEC,GAAGK,OAAOC,SAAf,YAA2BL,4JAAYC,OAAW,+CAClD,WACLH,EAAEQ,gBAEH,IAEHT,qBAAU,WACM,MAAVJ,GAA2B,MAATE,IAEtBF,EAAOc,KAAK,iBAAiB,SAAAC,GAC3Bb,EAAMc,YAAYD,GAClBb,EAAMe,YAGRjB,EAAOkB,KAAK,eAAgBtB,MAC3B,CAACI,EAAQE,EAAON,IAEnBQ,qBAAU,WACR,GAAc,MAAVJ,GAA2B,MAATE,EAAtB,CAEA,IAAMiB,EAAWC,aAAY,WAC3BpB,EAAOkB,KAAK,gBAAiBhB,EAAMmB,iBAhDhB,KAmDrB,OAAO,WACLC,cAAcH,OAEf,CAACnB,EAAQE,IAEZE,qBAAU,WACR,GAAc,MAAVJ,GAA2B,MAATE,EAAtB,CAEA,IAAMqB,EAAU,SAAAC,GACdtB,EAAMuB,eAAeD,IAIvB,OAFAxB,EAAO0B,GAAG,kBAAmBH,GAEtB,WACLvB,EAAO2B,IAAI,kBAAmBJ,OAE/B,CAACvB,EAAQE,IAEZE,qBAAU,WACR,GAAc,MAAVJ,GAA2B,MAATE,EAAtB,CAEA,IAAMqB,EAAU,SAACC,EAAOI,EAAUC,GACjB,SAAXA,GACJ7B,EAAOkB,KAAK,eAAgBM,IAI9B,OAFAtB,EAAMwB,GAAG,cAAeH,GAEjB,WACLrB,EAAMyB,IAAI,cAAeJ,OAE1B,CAACvB,EAAQE,IAEZ,IAAM4B,EAAaC,uBAAY,SAAAC,GAC7B,GAAe,MAAXA,EAAJ,CAEAA,EAAQC,UAAY,GACpB,IAAMC,EAASnB,SAASoB,cAAc,OACtCH,EAAQI,OAAOF,GACf,IAAMG,EAAI,IAAIC,IAAMJ,EAAQ,CAC1BK,MAAO,OACPC,QAAS,CAAEC,QAAStD,KAEtBkD,EAAEK,UACFL,EAAEM,QAAQ,cACVxC,EAASkC,MACR,IACH,OAAO,qBAAKO,UAAU,YAAYC,IAAKf,I,oBC/E1BgB,MAff,WACE,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAK,IAAIC,OAAK,EAArB,SACE,cAAC,IAAD,CAAUC,GAAE,qBAAgBC,mBAE9B,cAAC,IAAD,CAAOH,KAAK,iBAAZ,SACE,cAACpD,EAAD,Y,MCZVwD,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFtC,SAASuC,eAAe,W","file":"static/js/main.b33fbd61.chunk.js","sourcesContent":["import { useCallback, useEffect, useState } from \"react\"\nimport Quill from \"quill\"\nimport \"quill/dist/quill.snow.css\"\nimport { io } from \"socket.io-client\"\nimport { useParams } from \"react-router-dom\"\n\nconst SAVE_INTERVAL_MS = 2000\nconst TOOLBAR_OPTIONS = [\n  [{ header: [1, 2, 3, 4, 5, 6, false] }],\n  [{ font: [] }],\n  [{ list: \"ordered\" }, { list: \"bullet\" }],\n  [\"bold\", \"italic\", \"underline\"],\n  [{ color: [] }, { background: [] }],\n  [{ script: \"sub\" }, { script: \"super\" }],\n  [{ align: [] }],\n  [\"image\", \"blockquote\", \"code-block\"],\n  [\"clean\"],\n]\n\n\n\nexport default function TextEditor() {\n\n  \n  const { id: documentId } = useParams()\n  const [socket, setSocket] = useState()\n  const [quill, setQuill] = useState()\n\n  useEffect(() => {\n    \n    var s = io(process.env.PORT   || 'https://collab-editor-team12.herokuapp.com/' || `192.168.1.25:3001`)\n    setSocket(s)\n    console.log(s.io.engine.hostname)\n    s = io(`${s.io.engine.hostname}:${process.env.PORT}`  || 'https://collab-editor-team12.herokuapp.com/' || `${s.io.engine.hostname}:3001`)\n    return () => {\n      s.disconnect()\n    }\n  }, [])\n\n  useEffect(() => {\n    if (socket == null || quill == null) return\n\n    socket.once(\"load-document\", document => {\n      quill.setContents(document)\n      quill.enable()\n    })\n\n    socket.emit(\"get-document\", documentId)\n  }, [socket, quill, documentId])\n\n  useEffect(() => {\n    if (socket == null || quill == null) return\n\n    const interval = setInterval(() => {\n      socket.emit(\"save-document\", quill.getContents())\n    }, SAVE_INTERVAL_MS)\n\n    return () => {\n      clearInterval(interval)\n    }\n  }, [socket, quill])\n\n  useEffect(() => {\n    if (socket == null || quill == null) return\n\n    const handler = delta => {\n      quill.updateContents(delta)\n    }\n    socket.on(\"receive-changes\", handler)\n\n    return () => {\n      socket.off(\"receive-changes\", handler)\n    }\n  }, [socket, quill])\n\n  useEffect(() => {\n    if (socket == null || quill == null) return\n\n    const handler = (delta, oldDelta, source) => {\n      if (source !== \"user\") return\n      socket.emit(\"send-changes\", delta)\n    }\n    quill.on(\"text-change\", handler)\n\n    return () => {\n      quill.off(\"text-change\", handler)\n    }\n  }, [socket, quill])\n\n  const wrapperRef = useCallback(wrapper => {\n    if (wrapper == null) return\n\n    wrapper.innerHTML = \"\"\n    const editor = document.createElement(\"div\")\n    wrapper.append(editor)\n    const q = new Quill(editor, {\n      theme: \"snow\",\n      modules: { toolbar: TOOLBAR_OPTIONS },\n    })\n    q.disable()\n    q.setText(\"Loading...\")\n    setQuill(q)\n  }, [])\n  return <div className=\"container\" ref={wrapperRef}></div>\n}","import TextEditor from \"./TextEditor\"\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from \"react-router-dom\"\nimport { v4 as uuidV4 } from \"uuid\"\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/\" exact>\n          <Redirect to={`/documents/${uuidV4()}`} />\n        </Route>\n        <Route path=\"/documents/:id\">\n          <TextEditor />\n        </Route>\n      </Switch>\n    </Router>\n  )\n}\n\nexport default App\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport App from \"./App\"\nimport \"./styles.css\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}